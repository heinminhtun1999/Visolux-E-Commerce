<%- include('../shared/top', { title }) %>

<div class="row" style="justify-content:space-between; align-items:flex-end">
  <div>
    <h1 class="h1">Admin – Contact message</h1>
    <div class="muted small">Message #<%= message.id %> • <%= formatDateTime(message.created_at) %></div>
  </div>
  <div class="actions icon-row">
    <a class="btn btn-icon icon-only" href="/admin/contact-messages" title="Back" aria-label="Back" data-label="Back"><%- icon('back') %></a>
    <a class="btn btn-icon icon-only" href="/admin/settings" title="Settings" aria-label="Settings" data-label="Settings"><%- icon('gear') %></a>

    <% if (!message.is_read) { %>
      <form method="post" action="/admin/contact-messages/<%= message.id %>/read" style="display:inline">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
        <button class="btn btn-icon icon-only" type="submit" title="Mark read" aria-label="Mark read" data-label="Mark read"><%- icon('check') %></button>
      </form>
    <% } else { %>
      <form method="post" action="/admin/contact-messages/<%= message.id %>/unread" style="display:inline">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
        <button class="btn btn-icon icon-only" type="submit" title="Mark new" aria-label="Mark new" data-label="Mark new"><%- icon('x') %></button>
      </form>
    <% } %>

    <form method="post" action="/admin/contact-messages/<%= message.id %>/delete" style="display:inline" onsubmit="return confirm('Delete this message?');">
      <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
      <button class="btn btn-icon icon-only" type="submit" title="Delete" aria-label="Delete" data-label="Delete"><%- icon('x') %></button>
    </form>
  </div>
</div>

<div class="card" style="padding:14px; margin-top:12px">
  <div class="row" style="gap:14px; flex-wrap:wrap; align-items:flex-start">
    <div class="col" style="min-width:280px">
      <div class="muted small">Status</div>
      <% if (message.is_read) { %><span class="badge">Read</span><% } else { %><span class="badge ok">New</span><% } %>
    </div>

    <div class="col" style="min-width:280px">
      <div class="muted small">Name</div>
      <% if (message.phone) { %>
        <div><%= message.phone %></div>
      <% } else { %>
        <div class="muted">(not provided)</div>
      <% } %>
    </div>

    <div class="col" style="min-width:280px">
      <div class="muted small">Subject</div>
      <% if (message.location) { %>
        <div><%= message.location %></div>
      <% } else { %>
        <div class="muted">(not provided)</div>
      <% } %>
    </div>
  </div>

  <div style="margin-top:14px">
    <div class="muted small">Message</div>
    <div class="card" style="padding:12px; white-space:pre-wrap"><%= message.message %></div>
  </div>
</div>

<%- include('../shared/bottom') %>
